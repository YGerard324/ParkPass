{
  "version": 3,
  "sources": ["../../../src/decorators/legacy/model-hooks.ts"],
  "sourcesContent": ["import upperFirst from 'lodash/upperFirst.js';\nimport type { ModelHooks } from '../../model-hooks.js';\nimport { Model } from '../../model.js';\nimport { isModelStatic } from '../../utils/model-utils.js';\nimport { registerModelOptions } from '../shared/model.js';\nimport {\n  createOptionallyParameterizedPropertyDecorator,\n  throwMustBeMethod,\n  throwMustBeModel,\n  throwMustBeStaticProperty,\n} from './decorator-utils.js';\n\nexport interface HookOptions {\n  name?: string;\n}\n\n/**\n * Implementation for hook decorator functions. These are polymorphic. When\n * called with a single argument (IHookOptions) they return a decorator\n * factory function. When called with multiple arguments, they add the hook\n * to the model\u2019s metadata.\n *\n * @param hookType The type of hook\n */\nfunction createHookDecorator(hookType: keyof ModelHooks) {\n  return createOptionallyParameterizedPropertyDecorator<HookOptions | undefined>(\n    upperFirst(hookType),\n    undefined,\n    (options: HookOptions | undefined, targetModel, methodName) => {\n      if (typeof targetModel !== 'function') {\n        throwMustBeStaticProperty(upperFirst(hookType), targetModel, methodName);\n      }\n\n      if (!isModelStatic(targetModel)) {\n        throwMustBeModel(upperFirst(hookType), targetModel, methodName);\n      }\n\n      // @ts-expect-error -- implicit any, no way around it\n      const targetMethod: unknown = targetModel[methodName];\n      if (typeof targetMethod !== 'function') {\n        throwMustBeMethod(upperFirst(hookType), targetModel, methodName);\n      }\n\n      if (methodName in Model) {\n        throw new Error(\n          `Decorator @${upperFirst(hookType)} has been used on \"${targetModel.name}.${String(methodName)}\", but method ${JSON.stringify(methodName)} already exists on the base Model class and replacing it can lead to issues.`,\n        );\n      }\n\n      const callback = targetMethod.bind(targetModel);\n\n      registerModelOptions(targetModel, {\n        hooks: {\n          [hookType]: options?.name ? { name: options?.name, callback } : callback,\n        },\n      });\n    },\n  );\n}\n\nexport const BeforeBulkCreate = createHookDecorator('beforeBulkCreate');\nexport const AfterBulkCreate = createHookDecorator('afterBulkCreate');\n\nexport const BeforeBulkDestroy = createHookDecorator('beforeBulkDestroy');\nexport const AfterBulkDestroy = createHookDecorator('afterBulkDestroy');\n\nexport const BeforeBulkRestore = createHookDecorator('beforeBulkRestore');\nexport const AfterBulkRestore = createHookDecorator('afterBulkRestore');\n\nexport const BeforeBulkUpdate = createHookDecorator('beforeBulkUpdate');\nexport const AfterBulkUpdate = createHookDecorator('afterBulkUpdate');\n\nexport const BeforeAssociate = createHookDecorator('beforeAssociate');\nexport const AfterAssociate = createHookDecorator('afterAssociate');\n\nexport const BeforeCount = createHookDecorator('beforeCount');\n\nexport const BeforeCreate = createHookDecorator('beforeCreate');\nexport const AfterCreate = createHookDecorator('afterCreate');\n\nexport const BeforeDestroy = createHookDecorator('beforeDestroy');\nexport const AfterDestroy = createHookDecorator('afterDestroy');\n\nexport const BeforeDestroyMany = createHookDecorator('beforeDestroyMany');\nexport const AfterDestroyMany = createHookDecorator('afterDestroyMany');\n\nexport const BeforeFind = createHookDecorator('beforeFind');\nexport const BeforeFindAfterExpandIncludeAll = createHookDecorator(\n  'beforeFindAfterExpandIncludeAll',\n);\nexport const BeforeFindAfterOptions = createHookDecorator('beforeFindAfterOptions');\nexport const AfterFind = createHookDecorator('afterFind');\n\nexport const BeforeRestore = createHookDecorator('beforeRestore');\nexport const AfterRestore = createHookDecorator('afterRestore');\n\nexport const BeforeSave = createHookDecorator('beforeSave');\nexport const AfterSave = createHookDecorator('afterSave');\n\nexport const BeforeSync = createHookDecorator('beforeSync');\nexport const AfterSync = createHookDecorator('afterSync');\n\nexport const BeforeUpdate = createHookDecorator('beforeUpdate');\nexport const AfterUpdate = createHookDecorator('afterUpdate');\n\nexport const BeforeUpsert = createHookDecorator('beforeUpsert');\nexport const AfterUpsert = createHookDecorator('afterUpsert');\n\nexport const BeforeValidate = createHookDecorator('beforeValidate');\nexport const AfterValidate = createHookDecorator('afterValidate');\nexport const ValidationFailed = createHookDecorator('validationFailed');\n\nexport const BeforeDefinitionRefresh = createHookDecorator('beforeDefinitionRefresh');\nexport const AfterDefinitionRefresh = createHookDecorator('afterDefinitionRefresh');\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAAuB;AAEvB,mBAAsB;AACtB,yBAA8B;AAC9B,IAAAA,gBAAqC;AACrC,6BAKO;AAcP,SAAS,oBAAoB,UAA4B;AACvD,aAAO;AAAA,QACL,kBAAAC,SAAW,QAAQ;AAAA,IACnB;AAAA,IACA,CAAC,SAAkC,aAAa,eAAe;AAC7D,UAAI,OAAO,gBAAgB,YAAY;AACrC,kEAA0B,kBAAAA,SAAW,QAAQ,GAAG,aAAa,UAAU;AAAA,MACzE;AAEA,UAAI,KAAC,kCAAc,WAAW,GAAG;AAC/B,yDAAiB,kBAAAA,SAAW,QAAQ,GAAG,aAAa,UAAU;AAAA,MAChE;AAGA,YAAM,eAAwB,YAAY,UAAU;AACpD,UAAI,OAAO,iBAAiB,YAAY;AACtC,0DAAkB,kBAAAA,SAAW,QAAQ,GAAG,aAAa,UAAU;AAAA,MACjE;AAEA,UAAI,cAAc,oBAAO;AACvB,cAAM,IAAI;AAAA,UACR,kBAAc,kBAAAA,SAAW,QAAQ,uBAAuB,YAAY,QAAQ,OAAO,UAAU,kBAAkB,KAAK,UAAU,UAAU;AAAA,QAC1I;AAAA,MACF;AAEA,YAAM,WAAW,aAAa,KAAK,WAAW;AAE9C,8CAAqB,aAAa;AAAA,QAChC,OAAO;AAAA,UACL,CAAC,QAAQ,GAAG,SAAS,OAAO,EAAE,MAAM,SAAS,MAAM,SAAS,IAAI;AAAA,QAClE;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AACF;AAEO,MAAM,mBAAmB,oBAAoB,kBAAkB;AAC/D,MAAM,kBAAkB,oBAAoB,iBAAiB;AAE7D,MAAM,oBAAoB,oBAAoB,mBAAmB;AACjE,MAAM,mBAAmB,oBAAoB,kBAAkB;AAE/D,MAAM,oBAAoB,oBAAoB,mBAAmB;AACjE,MAAM,mBAAmB,oBAAoB,kBAAkB;AAE/D,MAAM,mBAAmB,oBAAoB,kBAAkB;AAC/D,MAAM,kBAAkB,oBAAoB,iBAAiB;AAE7D,MAAM,kBAAkB,oBAAoB,iBAAiB;AAC7D,MAAM,iBAAiB,oBAAoB,gBAAgB;AAE3D,MAAM,cAAc,oBAAoB,aAAa;AAErD,MAAM,eAAe,oBAAoB,cAAc;AACvD,MAAM,cAAc,oBAAoB,aAAa;AAErD,MAAM,gBAAgB,oBAAoB,eAAe;AACzD,MAAM,eAAe,oBAAoB,cAAc;AAEvD,MAAM,oBAAoB,oBAAoB,mBAAmB;AACjE,MAAM,mBAAmB,oBAAoB,kBAAkB;AAE/D,MAAM,aAAa,oBAAoB,YAAY;AACnD,MAAM,kCAAkC;AAAA,EAC7C;AACF;AACO,MAAM,yBAAyB,oBAAoB,wBAAwB;AAC3E,MAAM,YAAY,oBAAoB,WAAW;AAEjD,MAAM,gBAAgB,oBAAoB,eAAe;AACzD,MAAM,eAAe,oBAAoB,cAAc;AAEvD,MAAM,aAAa,oBAAoB,YAAY;AACnD,MAAM,YAAY,oBAAoB,WAAW;AAEjD,MAAM,aAAa,oBAAoB,YAAY;AACnD,MAAM,YAAY,oBAAoB,WAAW;AAEjD,MAAM,eAAe,oBAAoB,cAAc;AACvD,MAAM,cAAc,oBAAoB,aAAa;AAErD,MAAM,eAAe,oBAAoB,cAAc;AACvD,MAAM,cAAc,oBAAoB,aAAa;AAErD,MAAM,iBAAiB,oBAAoB,gBAAgB;AAC3D,MAAM,gBAAgB,oBAAoB,eAAe;AACzD,MAAM,mBAAmB,oBAAoB,kBAAkB;AAE/D,MAAM,0BAA0B,oBAAoB,yBAAyB;AAC7E,MAAM,yBAAyB,oBAAoB,wBAAwB;",
  "names": ["import_model", "upperFirst"]
}
